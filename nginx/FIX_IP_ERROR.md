# –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã: Let's Encrypt –Ω–µ –≤—ã–¥–∞–µ—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –¥–ª—è IP

## –ü—Ä–æ–±–ª–µ–º–∞

–í—ã –ø—ã—Ç–∞–µ—Ç–µ—Å—å –ø–æ–ª—É—á–∏—Ç—å SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –¥–ª—è IP-–∞–¥—Ä–µ—Å–∞ `31.59.106.143`, –Ω–æ Let's Encrypt **–Ω–µ –≤—ã–¥–∞–µ—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –¥–ª—è IP-–∞–¥—Ä–µ—Å–æ–≤**, —Ç–æ–ª—å–∫–æ –¥–ª—è –¥–æ–º–µ–Ω–Ω—ã—Ö –∏–º–µ–Ω.

## –†–µ—à–µ–Ω–∏–µ (–≤—ã–±–µ—Ä–∏—Ç–µ –æ–¥–∏–Ω –≤–∞—Ä–∏–∞–Ω—Ç)

### ‚úÖ –í–∞—Ä–∏–∞–Ω—Ç 1: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–æ–º–µ–Ω (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø –¥–ª—è Instagram)

Instagram webhooks —Ç—Ä–µ–±—É—é—Ç –≤–∞–ª–∏–¥–Ω—ã–π SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç. –°–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –º–æ–≥—É—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å.

**–®–∞–≥–∏:**

1. **–ü–æ–ª—É—á–∏—Ç–µ –¥–æ–º–µ–Ω** (–º–æ–∂–Ω–æ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π):
   - Freenom (–±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –¥–æ–º–µ–Ω—ã .tk, .ml, .ga)
   - –ò–ª–∏ –∫—É–ø–∏—Ç–µ –Ω–∞ Namecheap/GoDaddy (~$10/–≥–æ–¥)

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ DNS A-–∑–∞–ø–∏—Å—å**:
   ```
   webhook.yourdomain.com  A  31.59.106.143
   ```

3. **–û–±–Ω–æ–≤–∏—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é**:
   ```bash
   cd nginx
   # –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ nginx.conf –∏ init-letsencrypt.sh, –∑–∞–º–µ–Ω–∏—Ç–µ YOUR_DOMAIN –Ω–∞ –≤–∞—à –¥–æ–º–µ–Ω
   # –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:
   ./setup-ssl.sh  # –£–∫–∞–∂–∏—Ç–µ webhook.yourdomain.com
   ```

4. **–ü–æ–ª—É—á–∏—Ç–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç**:
   ```bash
   ./init-letsencrypt.sh
   docker-compose up -d
   ```

### ‚ö†Ô∏è –í–∞—Ä–∏–∞–Ω—Ç 2: –°–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (—Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)

**–í–Ω–∏–º–∞–Ω–∏–µ**: Instagram –º–æ–∂–µ—Ç –Ω–µ –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã!

```bash
cd nginx
./generate-self-signed.sh 31.59.106.143
```

–ó–∞—Ç–µ–º –æ–±–Ω–æ–≤–∏—Ç–µ `nginx/nginx.conf`:
```nginx
ssl_certificate /etc/letsencrypt/live/31_59_106_143/fullchain.pem;
ssl_certificate_key /etc/letsencrypt/live/31_59_106_143/privkey.pem;
```

–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ:
```bash
docker-compose restart nginx
```

### üîÑ –í–∞—Ä–∏–∞–Ω—Ç 3: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ngrok (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ ngrok
curl -s https://ngrok-agent.s3.amazonaws.com/ngrok.asc | sudo tee /etc/apt/trusted.gpg.d/ngrok.asc >/dev/null
echo "deb https://ngrok-agent.s3.amazonaws.com buster main" | sudo tee /etc/apt/sources.list.d/ngrok.list
sudo apt update && sudo apt install ngrok

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ ngrok
ngrok http 8002

# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS URL –æ—Ç ngrok –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö Instagram webhook
# –ù–∞–ø—Ä–∏–º–µ—Ä: https://abc123.ngrok.io/webhook/instagram
```

### ‚òÅÔ∏è –í–∞—Ä–∏–∞–Ω—Ç 4: Cloudflare (–±–µ—Å–ø–ª–∞—Ç–Ω—ã–π SSL)

1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ –¥–æ–º–µ–Ω
2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Cloudflare (–±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω)
3. –î–æ–±–∞–≤—å—Ç–µ –≤–∞—à –¥–æ–º–µ–Ω –≤ Cloudflare
4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ A-–∑–∞–ø–∏—Å—å: `webhook -> 31.59.106.143`
5. –í–∫–ª—é—á–∏—Ç–µ SSL –≤ Cloudflare (Flexible –∏–ª–∏ Full)
6. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–æ–º–µ–Ω –¥–ª—è webhook

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è

–î–ª—è **–ø—Ä–æ–¥–∞–∫—à–Ω-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å Instagram** –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ **–¥–æ–º–µ–Ω–Ω–æ–µ –∏–º—è** —Å –≤–∞–ª–∏–¥–Ω—ã–º SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–º –æ—Ç Let's Encrypt.

–î–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **ngrok**, –Ω–æ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω –Ω—É–∂–µ–Ω —Ä–µ–∞–ª—å–Ω—ã–π –¥–æ–º–µ–Ω.

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç —Å –¥–æ–º–µ–Ω–æ–º

–ï—Å–ª–∏ —É –≤–∞—Å —É–∂–µ –µ—Å—Ç—å –¥–æ–º–µ–Ω:

```bash
# 1. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ DNS A-–∑–∞–ø–∏—Å—å –Ω–∞ –≤–∞—à IP
# 2. –û–±–Ω–æ–≤–∏—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
cd nginx
sed -i 's/YOUR_DOMAIN/webhook.yourdomain.com/g' nginx.conf
sed -i 's/YOUR_DOMAIN/webhook.yourdomain.com/g' init-letsencrypt.sh
sed -i 's/YOUR_EMAIL/your@email.com/g' init-letsencrypt.sh

# 3. –ü–æ–ª—É—á–∏—Ç–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
./init-letsencrypt.sh

# 4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ
docker-compose up -d
```
